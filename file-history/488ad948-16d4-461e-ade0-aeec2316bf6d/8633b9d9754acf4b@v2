from __future__ import annotations

import requests
from bs4 import BeautifulSoup

headers = {
    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
}

html = requests.get('https://training.zendesk.com', headers=headers, timeout=30).text
soup = BeautifulSoup(html, 'html.parser')

# Look for actual course listings
print("=== SEARCHING FOR COURSE ELEMENTS ===\n")

# Check for specific Skilljar course structures
print("1. Links with /course or /path in href:")
course_links = soup.find_all('a', href=lambda x: x and ('/course' in x or '/path' in x or '/plan' in x))
print(f"   Found {len(course_links)} course/path links")
for link in course_links[:5]:
    print(f"   - {link.get('href')}")
    print(f"     Text: {link.get_text(strip=True)[:80]}")

print("\n2. Checking for catalog container:")
# Look for main catalog content
catalog_div = soup.find('div', class_=re.compile(r'catalog|courses|listings', re.I))
if catalog_div:
    print(f"   Found catalog div: {catalog_div.get('class')}")

print("\n3. Looking for actual course card structure:")
# Try to find the real course cards
import re
cards = soup.find_all('div', class_='course-box')
print(f"   Found {len(cards)} divs with class 'course-box'")

# Try alternate selectors
cards2 = soup.find_all('div', {'data-course-id': True})
print(f"   Found {len(cards2)} divs with data-course-id")

cards3 = soup.find_all('a', class_=re.compile(r'^course-'))
print(f"   Found {len(cards3)} links with 'course-' class")

# Check if there's a catalog listing
print("\n4. Looking for catalog structure:")
catalog_items = soup.find_all(['div', 'li'], class_=re.compile(r'catalog-item|course-item|class-item', re.I))
print(f"   Found {len(catalog_items)} catalog items")

# Look at the storefront structure
print("\n5. Examining storefront:")
storefront = soup.find('div', class_='storefront')
if storefront:
    print("   Found storefront div")
    # Get direct children
    children = storefront.find_all('div', recursive=False)
    print(f"   Direct children: {len(children)}")
    for i, child in enumerate(children[:3]):
        print(f"   Child {i} classes: {child.get('class')}")
        # Look for course links within
        links = child.find_all('a', href=True, limit=3)
        for link in links:
            href = link.get('href')
            if href and not href.startswith('#') and not href.startswith('javascript:'):
                print(f"      Link: {href} | {link.get_text(strip=True)[:50]}")

print("\n6. Sample HTML structure of storefront:")
if storefront:
    # Get first meaningful div
    sample = str(storefront)[:3000]
    print(sample)
